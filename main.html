<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>云车金融-全国业务分布</title>
</head>
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<link href="./map.css" rel="stylesheet" type="text/css"/>

<link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />

<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div class="yc_page">
  <div class="logo_box">
    <div class="top_bg_box">
      <img src="./image/topbg.png">
    </div>
    <div class="top_txt_box">
      <div class="top_time">
        <div class="top_time_box"><span class="hour_box"></span><span class="minute_box"></span><span class="second_box"></span></div>
        <div class="top_year_box"></div>

      </div>
      <div class="top_parent">
        <div class="top_parten_logo"></div>
        <div class="top_parten_txt">0</div>
      </div>
      <div class="top_beian">
        <div class="top_licensing_logo"></div>
        <div class="top_licensing_txt">0</div>
      </div>
    </div>
  </div>
<div class="yc_mid_box">
  <div class="left_box">
      <ul>
        <li>
          <p class="li_title_name"><span>全国</span>已开通省份数量</p>
          <p class="li_title_num">0</p>
        </li>
        <li>
          <p class="li_title_name"><span>全国</span>现有合伙人数量</p>
          <p class="li_title_num">0</p>
        </li>
        <li>
          <p class="li_title_name"><span>全国</span>跨区域合伙人城市数量</p>
          <p class="li_title_num">0</p>
        </li>
        <!--<li>-->
          <!--<p class="li_title_name"><span>全国</span>可备案城市数量</p>-->
          <!--<p class="li_title_num">0</p>-->
        <!--</li>-->
        <li>
          <p class="li_title_name"><span>全国</span>已备案城市数量</p>
          <p class="li_title_num">0</p>
        </li>
        <li>
          <p class="li_title_name"><span>全国</span>免备案城市数量</p>
          <p class="li_title_num">0</p>
        </li>
      </ul>
    <div class="pie">
      <div id="pie2" style="width: 140px;height: 140px; margin-top: 5px"></div>
      <div class="right_box">
        <p>
          <span class="pointer"></span>
          <span class="bank_name">城站支行</span>
        </p>
        <p>
          <span class="pointer2"></span>
          <span class="bank_name">哈尔滨顾乡支行</span>
        </p>
        <p>
          <span class="pointer3"></span>
          <span class="bank_name">台州路桥支行</span>
        </p>
      </div>
    </div>
  </div>
  <div class="canvas_box">
    <div class="canvas_tip">
      <p><span class="red_logo"></span><span>A 城市合伙人</span></p>
      <p><span class="green_logo"></span><span>B 备案完成</span></p>
    </div>
    <div class="mengc"></div>
      <div id="main" style="width:100%;height: 520px; "></div>
  </div>

  <div class="txt_box">
    <ul>
      <li class="ul_title">
        <span class="li_area">地区</span>
        <span class="li_beian">备案</span>
        <span class="li_parent">合伙人</span>
        <span class="li_cz">城站</span>
        <span class="heb_gx">哈尔滨顾乡</span>
        <span class="tzlq">台州路桥</span>
      </li>
      <ul class="outer_box">

      </ul>
    </ul>
  </div>
</div>
</div>
<!-- ECharts单文件引入 -->
<script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
<script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
<script src="./map.js"></script>
<script src="./api.js"></script>


<script type="text/javascript">
  // 路径配置

    require.config({
      paths: {
        echarts: 'http://echarts.baidu.com/build/dist'
      }
    });


  reduxpage()
  rightdata()
  function rightdata() { //加载全国省份数据
      var ccc =0;
      var ggg =0;
      var lll =0;
      $.ajax({
          url: "http://39.108.136.58:8080/query/country_record",    //
          dataType: "json",   //返回格式为json
          data: {
              province:''
          },    //参数值
          type: "GET",   //请求方式
          success: function (req) {
              var numberdata = req.service_response.business_response.businessData;
              numberdata.forEach(function(v,k){
                  window.province.forEach(function(v1,k2){
                      if(v.province == v1.name){
                          window.province[k2].c = v.c;
                          window.province[k2].g = v.g;
                          window.province[k2].l = v.l;
                          window.province[k2].per = v.per;
                          window.province[k2].reg = v.reg;
                      }

                  })
                  console.log(v,k)
                  ccc+=parseInt(v.c);
                  ggg +=parseInt(v.g);
                  lll+=parseInt(v.l);

              })

              window.ccc =ccc;
              window.ggg =ggg;
              window.lll =lll;
              window.province.sort(function (a,b) {
                  return parseInt(b.reg)-parseInt(a.reg)
              })
              var liget = '';

              window.province.forEach(function (t) {
                  var cc= t.c?t.c:'';
                  var gg =t.g?t.g:'';
                  var ll = t.l?t.l:'';
                  var reg =t.reg?t.reg:0;
                  var per =t.per?t.per:0;
                  if(cc =='' && gg=='' &&ll ==''&&reg ==0 && per ==0){
                      liget+='<li class="all_province"><span class="outer_area nodata">'+t.name+'</span><span class="outer_beian nodata">'+reg+'</span><span class="outer_parent nodata">'+per+'</span><span class="outer_cz kong">'+cc+'</span><span class="outer_gx">'+gg+'</span><span class="outer_tzlq">'+ll+'</span></li>'
                  }else{
                      liget+='<li class="all_province"><span class="outer_area">'+t.name+'</span><span class="outer_beian">'+reg+'</span><span class="outer_parent">'+per+'</span><span class="outer_cz kong">'+cc+'</span><span class="outer_gx">'+gg+'</span><span class="outer_tzlq">'+ll+'</span></li>'
                  }

              })
              window.liget= liget
              $(".outer_box").html(liget)
              $(".all_province").on("click",function (v,k) {
                  var index = $(this).index();
                  var selected = window.province[index].name
                  getprovincedata(selected);
                  smallmap_show(selected);
              })
          }
      })
  }
  function rightdata_reload() { //从小地图返回大地图的时候全国数据直接用之前的
      $(".outer_box").html('');
      var  liget = window.liget;
      $(".outer_box").html(liget);
      $(".all_province").on("click",function (v,k) {
          var index = $(this).index();
          var selected = window.province[index].name
          getprovincedata(selected);
          smallmap_show(selected);
      })
  }
  function reduxpage(){ // 使用 渲染页面数据(上右)
      $.ajax({
          url: "http://39.108.136.58:8080/query/statistics",
          dataType: "json",   //返回格式为json
          data: {
              province:''
          },    //参数值
          type: "GET",   //请求方式
          success: function (req) {
              console.log(req);
              var getdata = req.service_response.business_response.businessData;
              $(".top_parten_txt").html(getdata.count_partner);
              $(".top_licensing_txt").html(getdata.count_register_city);
              $(".li_title_num").eq(0).html(getdata.count_open_province);//全国已开通省份数量
              $(".li_title_num").eq(1).html(getdata.count_partner);//现有合伙人数量
              $(".li_title_num").eq(2).html(getdata.count_cross_partner);//跨区域合伙人城市数量
              //$(".li_title_num").eq(3).html();//可备案城市数量
              $(".li_title_num").eq(3).html(getdata.count_register_city);//已备案城市数量
              $(".li_title_num").eq(4).html(getdata.count_white_city);//免备案城市数量
              var yeardata = getdata.update_time.split(' ')[0];
              $('.top_year_box').html(yeardata);
              var hoursdata = getdata.update_time.split(' ')[1].split(':')[0];
              var minutedata = getdata.update_time.split(' ')[1].split(':')[1];
              var seconddata = getdata.update_time.split(' ')[1].split(':')[2];
              $('.hour_box').html(hoursdata);
              $(".minute_box").html(minutedata);
              $(".second_box").html(seconddata);
              setTimeout(function () {
                  pei(window.ccc/getdata.count_register_city,window.ggg/getdata.count_register_city,window.lll/getdata.count_register_city)
              },100)

          }
      })

  }

  $.ajax({
      url:"http://39.108.136.58:8080/query/licensing",    //备案所有 ，获取所有的备案和合伙人 用于描点
      dataType:"json",   //返回格式为json
      data:{},    //参数值
      type:"GET",   //请求方式
      success:function(req){
          //请求成功时处理
          req.service_response.business_response.businessData.forEach(function (v,k) {
              var provincename = v.province.split('省')[0];
              window.province.forEach(function(v1,k1){
                  if(v1.name == provincename){
                      window.province[k1].selected = true;
                          window.province[k1].licensing += 1;
                          window.licensingpoiter.push({
                              province:v.province,
                              name:v.city,
                              ip:v.position,
                              txt:v.bank,
                              val:5
                          });
                  }
              })
          })
           licensingPointer(window.licensingpoiter)
                $.ajax({
                    url: "http://39.108.136.58:8080/query/partner",    //合伙人所有
                    dataType: "json",   //返回格式为json
                    data: {},    //参数值
                    type: "GET",   //请求方式
                    success: function (res) {
                        res.service_response.business_response.businessData.forEach(function (v2,k2) {
                            var provincename_pa = v2.province;
                            window.province.forEach(function(v3,k4) {
                                if(v3.name == provincename_pa){
                                    window.province[k4].selected = true;
                                    window.province[k4].partner += 1;
                                    window.partnerpointer.push({
                                        province:v2.province,
                                        name:v2.city,
                                        ip:v2.position,
                                        txt:v2.name,
                                        val:4
                                    })
                                }
                              })
                            })
                        licensingPointer(window.partnerpointer)
                        buildmap()

                    }
                })
              }
  });
//备案




  function buildmap(){ //画地图
      require(
          [
              'echarts', // 使用柱状图就加载bar模块，按需加载
              'echarts/chart/map'
          ],
          function (ec) {
              // 基于准备好的dom，初始化echarts图表
              var myChart = ec.init(document.getElementById('main'));
              window.myChart = myChart;
              option = {
                  tooltip : {
                      trigger: 'item'
                  },
                  backgroundColor: '#0e0240',

                  toolbox: {
                      show : false
                  },
                  series : [
                      {
                          name: '省',
                          type: 'map',
                          mapType: 'china',
                          hoverable: false,
                          mapLocation: {
                              x: 'center',
                              y: 'center',
                              width: '80%'
                          },
                          tooltip:{
                              show:false
                          },
                          roam: false,
                          selectedMode : 'single',
                          itemStyle:{
                              normal: {
                                  borderColor:'#16c2ff',
                                  borderWidth:1,
                                  areaStyle: {
                                      color: '#2405e9'
                                  },
                                  label:{
                                      show:true,
                                      textStyle:{
                                          color:'#fff'
                                      }}
                              },
                              emphasis:{
                                  areaStyle: {
                                      color: '#00a3fe'
                                  },
                                  label:{
                                      show:true,
                                      textStyle:{
                                          color:'#fff'
                                      }
                                  }
                              }
                          },

                          data:window.province
                      },
                      {
                          name: '',
                          type: 'map',
                          mapType: 'china',
                          hoverable: false,
                          roam:false,
                          itemStyle:{
                              normal:{label:{show:true}},
                              emphasis:{label:{show:true}}
                          },
                          tooltip: {
                              trigger: 'item',
                              formatter:function (params,ticket,callback){
                                  var $pna = params.name;
                                  var res = '';

                                  for(var i = 0;i<window.pointerAll.length;i++){
                                      if(window.window.pointerAll[i].name == $pna){
                                          if(window.pointerAll[i].value == 4){
                                            res = '<div>'+window.pointerAll[i].city+'合伙人：'+window.pointerAll[i].txt+'</div>';
                                          }
                                          if(window.pointerAll[i].value == 5){
                                              res = '<div>'+window.pointerAll[i].city+'备案：'+window.pointerAll[i].txt+'</div>';
                                          }

                                          break;
                                      }
                                  }
                                  setTimeout(function () {
                                      callback(ticket, res);
                                  })
                                  // 仅为了模拟异步回调
                                  callback(ticket, res);//回调函数，这里可以做异步请求加载的一些代码
                              }
                          },
                          data : [],
                          markPoint : {
                              symbolSize: 4,       // 标注大小，半宽（半径）参数，当图形为方向或菱形则总宽度为symbolSize * 2
                              itemStyle: {
                                  normal: {
                                      borderColor: '#87cefa',
                                      borderWidth: 0,            // 标注边线线宽，单位px，默认为1
                                      label: {
                                          show: false
                                      }
                                  },
                                  emphasis: {
                                      borderColor: '#1e90ff',
                                      borderWidth: 0,
                                      label: {
                                          show: false
                                      }
                                  }
                              },
                              data : window.pointerAll
                          },
                          geoCoord: window.pointerNow
                      }
                  ],
                  animation: true
              };

              var ecConfig = require('echarts/config');

              myChart.on(ecConfig.EVENT.MAP_SELECTED, function (param){
                  var selected = param.target;
                  getprovincedata(selected);
                  smallmap_show(selected);
              });

              option.dataRange = {
                  orient: 'horizontal',
                  show:false,
                  x: '',
                  min: 0,
                  max: 5,
                  color:['#57f131','red','#38a2f7','#ffff79','#f5f5c2','#2405e9'],
                  text:['低','高'],           // 文本，默认为数值文本
                  splitNumber:0
              };

              // 为echarts对象加载数据
              myChart.setOption(option);
          }
      );
  }
  function pointredux(op) { //画饼图
          require(
              [
                  'echarts', // 使用柱状图就加载bar模块，按需加载
                  'echarts/chart/pie'
              ],
              function (ec) {
                  var myChart = ec.init(document.getElementById('pie1'));
                  var radius = [40, 55];
                  var labelFromatter = {
                      normal : {
                          label : {
                              formatter : function (params){
                                  return 100 - params.value + '%'
                              },
                              textStyle: {
                                  baseline : 'top'
                              }
                          }
                      }
                  };
                  var labelBottom = {
                      normal : {
                          color: '#ccc',
                          label : {
                              show : true,
                              position : 'center'
                          },
                          labelLine : {
                              show : false
                          }
                      },
                      emphasis: {
                          color: 'rgba(0,0,0,0)'
                      }
                  };
                  var labelTop = {
                      normal : {
                          label : {
                              show : true,
                              position : 'center',
                              formatter : '{b}',
                              textStyle: {
                                  baseline : 'bottom'
                              }
                          },
                          labelLine : {
                              show : false
                          }
                      }
                  };
                  option = {

                      calculable : false,
                      series : [
                          {
                              type : 'pie',

                              radius : radius,
                              x: '0%', // for funnel
                              itemStyle : labelFromatter,
                              data : [
                                  {name:'other', value:100-op, itemStyle : labelBottom},
                                  {name:'全国备案城市', value:op,itemStyle : labelTop}
                              ]
                          }
                      ]
                  };


                  myChart.setOption(option);
              }

          )
  }

</script>

<script>
  function pei(ccc,ggg,lll) {//左下一图渲染
      var ccc = parseInt(ccc*100);
      var ggg = parseInt(ggg*100);
      var lll = parseInt(lll*100);
      require(
          [
              'echarts', // 使用柱状图就加载bar模块，按需加载
              'echarts/chart/pie'
          ],
          function (ec) {
              var myChart = ec.init(document.getElementById('pie2'));
              var dataStyle = {
                  normal: {
                      label: {show:false},
                      labelLine: {show:false}
                  }
              };
              var placeHolderStyle = {
                  normal : {
                      color: '#ccc',
                      label: {show:false},
                      labelLine: {show:false}
                  },
                  emphasis : {
                      color: 'rgba(0,0,0,0)'
                  }
              };
              option = {
                  title: {
                      text: '备案银行',
                      subtext: '',

                      x: 'center',
                      y: 'center',
                      itemGap: 10,
                      textStyle : {
                          color : 'rgba(30,144,255,0.8)',
                          fontFamily : '微软雅黑',
                          fontSize : 12,
                          fontWeight : 'bolder'
                      }
                  },

                  legend: {
                      orient : 'vertical',
                      x : document.getElementById('main').offsetWidth / 2,
                      y : 15,
                      itemGap:12,
                      data:[]
                  },
                  toolbox: {
                      show : false,
                      feature : {
                          mark : {show: true},
                          dataView : {show: true, readOnly: false},
                          restore : {show: true},
                          saveAsImage : {show: true}
                      }
                  },
                  series : [
                      {
                          name:'1',
                          type:'pie',
                          clockWise:false,
                          radius : [25, 35],
                          itemStyle : dataStyle,
                          data:[
                              {
                                  value:ccc,
                                  color:'red'
                              },
                              {
                                  value:100-ccc,

                                  itemStyle : placeHolderStyle
                              }
                          ]
                      },
                      {
                          name:'2',
                          type:'pie',
                          clockWise:false,
                          radius : [35, 45],
                          itemStyle : dataStyle,
                          data:[
                              {
                                  value:ggg,
                                  name:'29%的人表示生活压力很大'
                              },
                              {
                                  value:100-ggg,
                                  name:'invisible',
                                  itemStyle : placeHolderStyle
                              }
                          ]
                      },
                      {
                          name:'3',
                          type:'pie',
                          clockWise:false,
                          radius : [45, 55],
                          itemStyle : dataStyle,
                          data:[
                              {
                                  value:lll,
                                  name:'3%的人表示“我姓曾”'
                              },
                              {
                                  value:100-lll,
                                  name:'invisible',
                                  itemStyle : placeHolderStyle
                              }
                          ]
                      }
                  ]
              };

              myChart.setOption(option);
          })
  }

  function getprovincedata(province_in) {//获取省份数据
      window.mmp = false;

      $.ajax({
          url: "http://39.108.136.58:8080/query/city_record",
          dataType: "json",   //返回格式为json
          data: {
              province:province_in
          },    //参数值
          type: "GET",   //请求方式
          success: function (req) {
              var req = req.service_response.business_response.businessData;
              $(".outer_box").html('');
             var provincenow = {};
              var liget = '';
              var pro_c = 0;
              var pro_g = 0;
              var pro_l = 0;
              var pro_per = 0;
              var pro_reg = 0;
              req.forEach(function (t) {
                  pro_reg += parseInt(t.reg);
                  pro_per += parseInt(t.per);
                  pro_c += parseInt(t.c);
                  pro_g += parseInt(t.g);
                  pro_l += parseInt(t.l);
              })
              //liget+='<li><span class="outer_area">'+province_in+'</span><span class="outer_beian">'+pro_reg+'</span><span class="outer_parent">'+pro_per+'</span><span class="outer_cz kong">'+pro_c+'</span><span class="outer_gx">'+pro_g+'</span><span class="outer_tzlq">'+pro_l+'</span></li>'
              window.chinamap.forEach(function(v,k){
                if(v.province == province_in && !window.mmp){
                      v.city.forEach(function(v1,k1){
                        req.forEach(function (v2,k2) {
                            if(v1.name == v2.city){
                                v1.c =v2.c;
                                v1.g = v2.g;
                                v1.l = v2.l;
                                v1.per = v2.per;
                                v1.reg = v2.reg;
                            }

                        })
                      })
                    window.citylistinuse = v.city;
                    window.citylistinuse.forEach(function(t){
                        var cc= t.c==0||!t.c?'':t.c;
                        var gg =t.g==0||!t.g?'':t.g;
                        var ll = t.l==0||!t.l?'':t.l;
                        var reg = t.reg==0||!t.reg?'':t.reg;
                        var per = t.per ==0||!t.per?'':t.per;
                        if(cc =='' && gg=='' &&ll ==''&&reg ==''&&per==''){
                            liget+='<li><span class="outer_area nodata">'+t.name+'</span><span class="outer_beian nodata">'+reg+'</span><span class="outer_parent nodata">'+per+'</span><span class="outer_cz kong">'+cc+'</span><span class="outer_gx">'+gg+'</span><span class="outer_tzlq">'+ll+'</span></li>'
                        }else{
                            liget+='<li><span class="outer_area">'+t.name+'</span><span class="outer_beian" >'+reg+'</span><span class="outer_parent" >'+per+'</span><span class="outer_cz kong" >'+cc+'</span><span class="outer_gx" >'+gg+'</span><span class="outer_tzlq" >'+ll+'</span></li>'
                        }
                    })
                    $(".outer_box").html(liget)
                    window.mmp = true;
                }
              })

          }
      })
  }
  function smallmap_show(selected) {
      $(".mengc").show();
      if(window.provincechoose != selected){ //获得小地图的地址
          window.provincepa_data = {};
          window.provinceli_data = [];
          window.pointerAll.forEach(function(v,k){
              console.log(v.province,selected)
              if(v.province ==selected){
                  var value_name = v.name;
                  var value_main = window.pointerNow[value_name];
                  window.provincepa_data[value_name] = value_main;
                  window.provinceli_data.push(window.pointerAll[k])
              }
          })
      }
      option.series[0].mapLocation.width = '20%';
      option.series[0].mapLocation.x ='left';
      option.series[0].mapLocation.y = 'top';
      option.series[1] = {};
      option.series[0].itemStyle.emphasis.label.show = false;
      option.series[0].itemStyle.normal.label.show = false;
      option.series[2] = {
          name: '',
          type: 'map',
          mapType: selected,
          itemStyle:{
              normal:{label:{show:true}},
              emphasis:{label:{show:true}}
          },
          mapLocation: {
              x: '25%',
              width: '65%'
          },
          roam: true,
          itemStyle:{
              normal: {
                  borderColor:'#16c2ff',
                  borderWidth:1,
                  areaStyle: {
                      color: '#ccc'
                  },
                  label:{
                      show:true,
                      textStyle:{
                          color:'#fff'
                      }}
              },
              emphasis:{
                  areaStyle: {
                      color: '#00a3fe'
                  },
                  label:{
                      show:true,
                      textStyle:{
                          color:'#fff'
                      }
                  }
              }
          },
          roam: true,
          data:window.citydata,
          tooltip: {                 //小地图hover设置
              show:false
          }

      };
      option.series[2].hoverable = false;
      option.series[3] ={
          name: '',
          type: 'map',
          mapType: selected,
          hoverable: false,
          roam:true,
          itemStyle:{
              normal:{label:{show:true}},
              emphasis:{label:{show:true}}
          },
          tooltip: { //小地图点hover
              trigger: 'item',
              formatter:function (params,ticket,callback){
                  var $pna = params.name;
                  var res = '';

                  for(var i = 0;i<window.pointerAll.length;i++){
                      if(window.window.pointerAll[i].name == $pna){

                          if(window.pointerAll[i].value == 4){
                              res = '<div>'+window.pointerAll[i].city+'合伙人:'+window.pointerAll[i].txt+'</div>';

                          }
                          if(window.pointerAll[i].value == 5){
                              res = '<div>'+window.pointerAll[i].city+'备案：'+window.pointerAll[i].txt+'</div>';
                          }

                          break;
                      }
                  }

                  setTimeout(function () {
                      callback(ticket, res);
                  })
                  // 仅为了模拟异步回调
                  callback(ticket, res);//回调函数，这里可以做异步请求加载的一些代码
              }
          },
          data : [],
          markPoint : {
              symbolSize: 6,       // 标注大小，半宽（半径）参数，当图形为方向或菱形则总宽度为symbolSize * 2
              itemStyle: {
                  normal: {
                      borderColor: '#87cefa',
                      borderWidth: 0,            // 标注边线线宽，单位px，默认为1
                      label: {
                          show: false
                      }
                  },
                  emphasis: {
                      borderColor: 'red',
                      borderWidth: 4,
                      symbolSize: 4,
                      label: {
                          show: false
                      }
                  }
              },
              data : window.provinceli_data
          },
          geoCoord: window.provincepa_data
      }
      window.myChart.setOption(option, true);
      $(".mengc").on("click",function(){
          $(".mengc").hide();
          rightdata_reload()
          option.series = option.series.slice(0,2);

          option.series[0].mapLocation.width= '100%';
          option.series[0].mapLocation.x ='center';
          option.series[0].mapLocation.y = 'center';
          option.series[0].itemStyle.emphasis.label.show = true;
          option.series[0].itemStyle.normal.label.show = true;
          option.series[1] ={
              name: '',
                  type: 'map',
              mapType: 'china',
              hoverable: false,
              roam:false,
              itemStyle:{
              normal:{label:{show:true}},
              emphasis:{label:{show:true}}
          },
              tooltip: {
                  trigger: 'item',
                      formatter:function (params,ticket,callback){
                      var $pna = params.name;
                      var res = '';

                      for(var i = 0;i<window.pointerAll.length;i++){
                          if(window.window.pointerAll[i].name == $pna){
                              if(window.pointerAll[i].value == 4){
                                  res = '<div>'+window.pointerAll[i].city+'合伙人：'+window.pointerAll[i].txt+'</div>';
                              }
                              if(window.pointerAll[i].value == 5){
                                  res = '<div>'+window.pointerAll[i].city+'备案：'+window.pointerAll[i].txt+'</div>';
                              }

                              break;
                          }
                      }
                      setTimeout(function () {
                          callback(ticket, res);
                      })
                      // 仅为了模拟异步回调
                      callback(ticket, res);//回调函数，这里可以做异步请求加载的一些代码
                  }
              },
              data : [],
                  markPoint : {
              symbolSize: 4,       // 标注大小，半宽（半径）参数，当图形为方向或菱形则总宽度为symbolSize * 2
                  itemStyle: {
                  normal: {
                      borderColor: '#87cefa',
                          borderWidth: 0,            // 标注边线线宽，单位px，默认为1
                          label: {
                          show: false
                      }
                  },
                  emphasis: {
                      borderColor: '#1e90ff',
                          borderWidth: 0,
                          label: {
                          show: false
                      }
                  }
              },
              data : window.pointerAll
          },
              geoCoord: window.pointerNow
          }
          myChart.setOption(option,true);
          return;
      })
  }

</script>

</body>
